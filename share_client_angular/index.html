<!DOCTYPE html>
<html ng-app="myApp">
    <head>
        <meta charset="utf-8">
        <title>Utils Test</title>
        <link rel="stylesheet" href="vendor/bootstrap/dist/css/bootstrap.css" media="screen" title="no title" charset="utf-8">
        <script type="text/javascript" src="vendor/angular/angular.js"></script>
        <script type="text/javascript" src="js/angular-utils-table.min.js"></script>
        <script type="text/javascript" src="vendor/jquery/jquery.min.js"></script>
    </head>
    <body ng-controller="myController">

        <script type="text/javascript">
            var setConfig = function (data) {
                var a = {
                    appId: data.appId,
                    timestamp: data.timestamp,
                    nonceStr: data.nonceStr,
                    signature: data.signature
                }

                alert(JSON.stringify(a));
                wx.config({
                    debug: true,
                    appId: data.appId,
                    timestamp: data.timestamp,
                    nonceStr: data.nonceStr,
                    signature: data.signature,
                    jsApiList: ['checkJsApi', 'onMenuShareTimeline']
                });
            }
            function getUrlParam(name) {
                var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
                var r = window.location.search.substr(1).match(reg); //匹配目标参数
                if (r != null) 
                    return unescape(r[2]);
                return null; //返回参数值
            }
            alert(window.location);
            var urlPath = window.location;

            $.ajax({
                url: 'http://zhuyunxiang.com/share/wechatAPI/getTickets',
                method: 'POST',
                data: $.param({'url': urlPath}),
                success: function (data) {
                    alert(JSON.stringify(data));
                    setConfig(data);
                }
            });

            var myApp = angular.module('myApp', ['Utils-table', 'Controllers']);
            var Controllers = angular.module('Controllers', []);
            Controllers.controller('myController', ['$scope', function ($scope) {}]);
        </script>
    </body>
</html>